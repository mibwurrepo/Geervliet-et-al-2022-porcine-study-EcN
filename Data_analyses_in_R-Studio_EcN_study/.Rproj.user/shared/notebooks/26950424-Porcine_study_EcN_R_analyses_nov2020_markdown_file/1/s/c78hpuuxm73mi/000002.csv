"0","# create phyloseq object of all libraries"
"0","ps <- read_phyloseq(otu.file = ""./input_data/Galaxy58-[NG-Tax__porcine_study_all_samples_eightrun_length70bp_11march2020].biom1"", "
"0","                    taxonomy.file = NULL, "
"0","                    metadata.file = ""./input_data/Metadata_porcine_study_june_2020.csv"", "
"0","                    type = ""biom"")"
"2","Time to complete depends on OTU file size
"
"0","# create tree object"
"0","treefile <- read.tree(""./input_data/all_otus_eightrun_length70bp_11march2020.tre"")"
"0","# merge tree and phyloseq object"
"0","ps1.all <- merge_phyloseq(ps,treefile)"
"0","print(ps1.all)"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 4157 taxa and 490 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 490 samples by 171 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 4157 taxa by 6 taxonomic ranks ]"
"1","
"
"1","phy_tree()    Phylogenetic Tree: [ 4157 tips and 4156 internal nodes ]"
"1","
"
"0","# export taxonomy table (for Windows)"
"0","taxonomy_table_ps1 <- as.data.frame(ps1.all@tax_table)"
"0","write.csv(taxonomy_table_ps1, file = ""./output_data/taxonomy_table_ps1.csv"", fileEncoding = ""UTF-16LE"") "
"0","ntaxa(ps1.all)"
"1","[1]"
"1"," 4157"
"1","
"
