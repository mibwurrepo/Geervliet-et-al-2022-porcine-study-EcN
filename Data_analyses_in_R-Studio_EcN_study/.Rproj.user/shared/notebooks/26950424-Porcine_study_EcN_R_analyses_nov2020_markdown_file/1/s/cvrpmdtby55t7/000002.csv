"0","ps1 <- readRDS(""./phyobjects/ps1.EcN.rds"")"
"0",""
"0","taxa_names(physeq = ps1) <- interaction(rownames(ps1@tax_table),ps1@tax_table[,""Genus""],ps1@tax_table[,""Family""])"
"0",""
"0","ps1 <- microbiome::transform(ps1, ""compositional"")"
"0",""
"0","ps1 <- subset_taxa(ps1, Phylum == ""Proteobacteria"")"
"0",""
"0","ps1@sam_data$Day_of_study_factor <- factor(ps1@sam_data$Day_of_study_factor, levels = c(""Day_4"", ""Day_8"", ""Day_14"", ""Day_26"", ""Day_27"", ""Day_35"", ""Day_43"", ""Day_44"", ""Day_59"", ""Day_69"", ""Day_70""))"
"0","ps1@sam_data$Pre_or_post_weaning <- factor(ps1@sam_data$Pre_or_post_weaning, levels = c(""Pre_weaning"", ""Post_weaning""))"
"0",""
"0","ps1 <- subset_samples(ps1, Origin %in% c(""faeces""))"
"0","ps1 <- subset_samples(ps1, Pre_or_post_weaning %in% c(""Pre_weaning""))"
"0",""
"0","metadata <- ps1@sam_data"
"0","treatment1 <- rownames(metadata[metadata$Treatment != ""Control""])"
"0","treatment2 <- rownames(metadata[metadata$Treatment == ""Control""])"
"0",""
"0","otu <- as.data.frame(ps1@otu_table)"
"0","taxa_group1 <- otu[,treatment1]"
"0","taxa_group2 <- otu[,treatment2]"
"0",""
"0","significant <- list()"
"0","for (i in rownames(taxa_group1)){"
"0","  x = wilcox.test(x= as.numeric(taxa_group1[i,]),y = as.numeric(taxa_group2[i,]),paired = F,exact = F)"
"0","  significant[[i]] <- x$p.value  "
"0","} "
"0",""
"0","my_taxa <- do.call(rbind.data.frame, significant)"
"0","rownames(my_taxa) <-  rownames(taxa_group1)"
"0","my_taxa[,2] <- 1"
"0","my_taxa[,3] <- ""whatev"""
"0",""
"0","colnames(my_taxa) <- c(""pval"",""corrected"",""taxon"")"
"0","my_taxa$taxon <- rownames(my_taxa)"
"0",""
"0","my_taxa$corrected <- p.adjust(my_taxa[,1], method = ""BH"")"
"0",""
"0","significantly_different_taxa <- my_taxa[which(my_taxa$corrected < 1),]"
"0","significantly_different_taxa2 <- rownames(significantly_different_taxa)"
"0",""
"0","ps1.significantly_different_taxa <- ps1"
"0","ps1.significantly_different_taxa@otu_table <- ps1@otu_table[significantly_different_taxa2,]"
"0","ps1.significantly_different_taxa@tax_table <- ps1@tax_table[significantly_different_taxa2,]"
"0",""
"0","p <- plot_heatmap(ps1.significantly_different_taxa, method = ""PCA"", sample.order = ""Ear_tag"", title = ""Heatmap_of_pre_weaning_proteobacteria"", taxa.order = ""Genus"", sample.label=""Ear_tag"", low=""#FFFFCC"", high=""#000033"", na.value=""white"") + facet_grid(~Day_of_study_factor + Treatment, scales = ""free"") "
"0",""
"0","p"
